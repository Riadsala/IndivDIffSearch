rm(b1,b2,beta1,beta2,dist,end_dist,iter,skew,spreads,success,temp)
beta_frame %>%
mutate(spread = as.factor(spread)) %>%
group_by(skew, spread, delta) %>%
mutate(avg_success = mean(success)) %>%
ggplot(aes(delta, avg_success, colour = spread)) +
geom_point() +
stat_smooth(method = glm,
method.args = list(family = "binomial"),
aes(y = success),
se = F) +
scale_x_continuous(breaks = seq(100,900,200)) +
facet_wrap(~skew)
ggplot(aes(x = seq(0,1,0.01), y =  dbeta(x, 3,3))) + geom_line()
ggplot(data = data.frame(x = seq(0,1,0.01), y =  dbeta(x, 3,3)), aes(x,y)) + geom_line()
head(beta)
head(betas)
distr_plots <- data.frame(x = numeric(),
y = numeric())
# set x
x <- seq(0,1,0.01)
for(skew in unique(betas$skew)){
temp <- betas[betas$skew == skew,]
# now spread
for(spread in unique(spread_settings)){
y <- dbeta(x, temp$beta1*spread, temp$beta2*spread)
# add to frame
distr_plots <- rbind(distr_plots, data.frame(skew = skew,
spread = spread,
x = x,
y = y))
}
}
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x,y, colour = spread)) +
geom_line() +
facet_wrap(~skew)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(round(x*max_speed)+1,y, colour = spread)) +
geom_line() +
facet_wrap(~skew)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = spread)) +
geom_line() +
facet_wrap(~skew)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = skew)) +
geom_line() +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = skew)) +
geom_line() +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = skew, fill = skew)) +
geom_line() +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = skew)) +
geom_line() +
facet_wrap(~spread)
beta_frame %>%
mutate(spread = as.factor(spread)) %>%
group_by(skew, spread, delta) %>%
mutate(avg_success = mean(success)) %>%
ggplot(aes(delta, avg_success, colour = skew)) +
geom_point() +
stat_smooth(method = glm,
method.args = list(family = "binomial"),
aes(y = success),
se = F) +
scale_x_continuous(breaks = seq(100,900,200)) +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed,y, colour = skew)) +
geom_line() +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed + 1,y, colour = skew)) +
geom_line() +
facet_wrap(~spread)
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed + 1,y, colour = skew)) +
geom_line() +
scale_x_continuous(breaks = c(2,4,6,8)) +
facet_wrap(~spread)
beta_frame %>%
mutate(spread = as.factor(spread)) %>%
group_by(skew, spread, delta) %>%
mutate(avg_success = mean(success)) %>%
ggplot(aes(delta, avg_success, colour = skew)) +
geom_point() +
stat_smooth(method = glm,
method.args = list(family = "binomial"),
aes(y = success),
se = F) +
scale_x_continuous(breaks = seq(100,900,200)) +
facet_wrap(~spread)
# packages
library(tidyverse)
# some constants
# screen x res
x_res <- 1920
# first make sigmoid function
delta <- seq(1, x_res/2, 1)
a <- (15/max(delta))*-1
c <- max(delta)/2
success_rate <- 1/(1+exp(-a*(delta-c)))
plot(delta, success_rate, type = "l")
# tidy
rm(a,c, delta)
# make list of deltas
delta_list = seq(100, x_res/2, 100)
travel_time <- 100
max_speed <- (max(delta_list)/travel_time) - 1
# different distribution combinations
betas <- data.frame(skew = c("left", "centre", "right"),
beta1 = c(3, 3, 7),
beta2 = c(7, 3, 3))
spread_settings <- c(1, 10)
# setup data frame for loop
beta_frame <- data.frame(iter = numeric(),
skew = character(),
spread = numeric(),
delta = numeric(),
end_dist = numeric(),
success = numeric())
# now loop
for(skew in unique(betas$skew)){
# temp frame
temp <- betas[betas$skew == skew,]
# now loop through sizes
for(spreads in unique(spread_settings)){
beta1 <- temp$beta1 * spreads
beta2 <- temp$beta2 * spreads
# loop through dists
for(dist in unique(delta_list)){
for(iter in 1:1000){
# set speed
end_dist <- (round(rbeta(1,beta1,beta2)*max_speed) + 1) * travel_time
# set success
success <- 0
# check
if(end_dist >= dist){
success <- 1
end_dist <- dist
}
# add to data frame
beta_frame <- rbind(beta_frame, data.frame(iter = iter,
skew = skew,
spread = spreads,
delta = dist,
end_dist = end_dist,
success = success))
}
}
}
}
# tidy
rm(beta1,beta2,dist,end_dist,iter,skew,spreads,success,temp)
distr_plots <- data.frame(skew = character(),
spread = spread(),
x = numeric(),
y = numeric())
# set x
x <- seq(0,1,0.01)
for(skew in unique(betas$skew)){
temp <- betas[betas$skew == skew,]
# now spread
for(spread in unique(spread_settings)){
y <- dbeta(x, temp$beta1*spread, temp$beta2*spread)
# add to frame
distr_plots <- rbind(distr_plots, data.frame(skew = skew,
spread = spread,
x = x,
y = y))
}
}
distr_plots <- data.frame(skew = character(),
spread = spread(),
x = numeric(),
y = numeric())
distr_plots <- data.frame(skew = character(),
spread = character(),
x = numeric(),
y = numeric())
x <- seq(0,1,0.01)
for(skew in unique(betas$skew)){
temp <- betas[betas$skew == skew,]
# now spread
for(spread in unique(spread_settings)){
y <- dbeta(x, temp$beta1*spread, temp$beta2*spread)
# add to frame
distr_plots <- rbind(distr_plots, data.frame(skew = skew,
spread = spread,
x = x,
y = y))
}
}
# make plots of this
distr_plots %>%
mutate(spread = as.factor(spread)) %>%
ggplot(aes(x*max_speed + 1,y, colour = skew)) +
geom_line() +
scale_x_continuous(breaks = c(2,4,6,8)) +
facet_wrap(~spread)
beta_frame %>%
mutate(spread = as.factor(spread)) %>%
group_by(skew, spread, delta) %>%
mutate(avg_success = mean(success)) %>%
ggplot(aes(delta, avg_success, colour = skew)) +
geom_point() +
stat_smooth(method = glm,
method.args = list(family = "binomial"),
aes(y = success),
se = F) +
scale_x_continuous(breaks = seq(100,900,200)) +
facet_wrap(~spread)
setwd("F:/Uni/PhD/2nd Year/Foraging_paper")
dir()
df <- read.csv("data/all_data.CSV", header = F)
head(df)
df <- read.csv("data/all_data.CSV", header = F)
colnames(df) <- c("Participant",
"Trial",
"Exp_condition",
"Symbol_condition",
"Touch_Count",
"Target_ID",
"Target_X",
"Target_Y",
"Trial_Time",
"Touch_Time",
"Target_Rep",
"Rep_count",
"Distance_to_Last",
"Run_Length",
"Line_Num")
head(df)
str(df)
range(df$Target_Rep)
df$Participant <- as.factor(df$Participant)
df$Exp_condition <- as.factor(df$Exp_condition)
df$Symbol_condition <- as.factor(df$Symbol_condition)
df$Target_ID <- as.factor(df$Target_ID)
str(df)
range(df$Rep_count)
View(df)
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_time), mean_RL = mean(Rep_Length))
library(tidyverse)
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_time), mean_RL = mean(Rep_Length))
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_Time), mean_RL = mean(Rep_Length))
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_Time), mean_RL = mean(Run_Length))
df %>%
group_by(Participant, Run_Length) %>%
summarise(mean_RT = mean(Trial_Time))
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Run_Length))
summary(df)
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_Time),
num_runs = sum(Target_Rep))
df %>%
group_by(Participant) %>%
summarise(mean_RT = mean(Trial_Time),
num_runs = sum(Target_Rep)/max(Trial))
head(df)
View(df)
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep))
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT)) +
geom_point() +
facet_wrap(~Exp_condition)
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT, colour = Exp_condition)) +
geom_point() +
facet_wrap(~Participant)
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT, colour = Exp_condition)) +
geom_point(shape = Exp_condition) +
facet_wrap(~Participant)
f %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT, colour = Exp_condition)) +
geom_point(aes(shape = Exp_condition)) +
facet_wrap(~Participant)
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT, colour = Exp_condition)) +
geom_point(aes(shape = Exp_condition)) +
facet_wrap(~Participant)
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_TR = mean(Target_Rep)) %>%
ggplot(aes(mean_TR, mean_RT, colour = Participant)) +
geom_point(aes(shape = Exp_condition))
df %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
Repetition_Rate = mean(Target_Rep)) %>%
ggplot(aes(Repetition_Rate, mean_RT, colour = Participant)) +
geom_point(aes(shape = Exp_condition))
head(df)
df %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run))
df %>%
group_by(Pariticpant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length))
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length))
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length))
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>% arrange(Participant, Largest_run)
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>% select(Participant, Trial, Largest_run)
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run))
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run)) %>%
ggplot(aes(mean_RL, mean_RT, colour = Participant)) +
geom_point(aes(shape = Exp_condition))
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run)) %>%
ggplot(aes(mean_RL, mean_RT, colour = Participant)) +
geom_point(aes(shape = Exp_condition)) +
facet_wrap(~Participant)
df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run)) %>%
ggplot(aes(mean_RL, mean_RT, colour = Exp_condition)) +
geom_point() +
facet_wrap(~Participant)
plt <- df %>%
group_by(Participant, Exp_condition, Trial) %>%
mutate(Largest_run = max(Run_Length)) %>%
group_by(Participant, Exp_condition) %>%
summarise(mean_RT = mean(Trial_Time),
mean_RL = mean(Largest_run)) %>%
ggplot(aes(mean_RL, mean_RT, colour = Exp_condition)) +
geom_point() +
facet_wrap(~Participant)
plt$labels$x <- "Mean Run Length"
plt
setwd("F:/Uni/Github/IndivDIffSearch/Manuscript/sup_mat")
dir()
dir("..")
dir("../")
dir("../../")
dir("../../Data/")
dir("../../")
dir("../../Scripts/")
dir("..")
dir("../../")
dir("../../Scripts/scratch/")
dir("../../Scripts/lineseg/scratch/")
rm(list = ls())
setwd("F:/Uni/Github/IndivDIffSearch/Manuscript/sup_mat")
dir("../..")
dir("../../Scripts")
ls_acc_RT <- readRDS(file = "../../Scripts/lineseg/scratch/processedRTandAccData.Rda")
head(ls_acc_RT)
length(unique(ls_acc_RT$responseKey))
length(unique(ls_acc_RT$observer))
ls_acc_RT %>% group_by(observer, targSide, session)
ls_acc_RT %>% group_by(observer, targSide, session) %>% summarise(mean_acc = mean(accuracy))
lt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
facet_wrap(~observer)
plt <- lt
plt
lt
plt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
theme(axis.text.x  = element_text(angle=90, vjust=0.5)) +
facet_wrap(~observer)
plt
plt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
theme(axis.text.x  = element_text(angle=90, vjust=0.5)) +
facet_wrap(~observer)
plt$labels$x <- "Target Condition"
plt
plt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
theme(axis.text.x  = element_text(angle=90, vjust=0.5), legend.position="top") +
theme_bw() +
scale_fill_ptol() +
facet_wrap(~observer)
plt$labels$x <- "Target Condition"
plt
install.packages("ggthemes")
library(ggthemes)
plt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
theme(axis.text.x  = element_text(angle=90, vjust=0.5), legend.position="top") +
theme_bw() +
scale_fill_ptol() +
facet_wrap(~observer)
plt$labels$x <- "Target Condition"
plt
plt <- ls_acc_RT %>%
group_by(observer, targSide, session) %>%
summarise(Accuracy = mean(accuracy)) %>%
ggplot(aes(targSide, Accuracy, fill = session)) +
geom_bar(stat = "identity", position = position_dodge()) +
scale_y_continuous(breaks = c(0,1)) +
theme(axis.text.x  = element_text(angle=90, vjust=0.5)) +
theme_bw() +
scale_fill_ptol() +
facet_wrap(~observer)
plt$labels$x <- "Target Condition"
plt
plt
avg_acc_all <- mean(ls_acc_RT$accuracy)
avg_acc_all
head(ls_acc_RT)
colnames(ls_acc_RT)
ls_acc_RT %>%
group_by(observer,targSide) %>%
summarise(Acc = mean(accuracy))
unique(ls_acc_RT$observer)
8^2
length(ls_acc_RT$observer)
length(unique(ls_acc_RT$observer))
ls_acc_RT$observer <- as.factor(as.numeric(ls_acc_RT$observer))
# number of participants used
num_participants <- length(unique(ls_acc_RT$observer))
avg_acc_all <- ls_acc_RT %>%
group_by(observer,targSide) %>%
summarise(Acc = mean(accuracy))
avg
